(function(i,s){typeof exports=="object"&&typeof module<"u"?s(exports):typeof define=="function"&&define.amd?define(["exports"],s):(i=typeof globalThis<"u"?globalThis:i||self,s(i.TinymceInlineComments={}))})(this,(function(i){"use strict";function s(e){const c="inline_comment",m="inline-comment";e.on("init",()=>{e.formatter.register(c,{inline:"span",classes:m,attributes:{"data-annotation-id":"%value"}})}),e.addCommand("inline-comments:add",()=>{if(e.selection.isCollapsed())return;const t=crypto.randomUUID(),o=e.selection.getContent({format:"text"});e.undoManager.transact(()=>{e.formatter.apply(c,{value:t})}),e.fire("inline-comments:add",{annotationId:t,selectedText:o})}),e.removeInlineComment=t=>{e.undoManager.transact(()=>{e.dom.select(`span[data-annotation-id="${t}"]`).forEach(n=>{const a=n.parentNode;if(a){for(;n.firstChild;)a.insertBefore(n.firstChild,n);a.removeChild(n)}})}),e.fire("inline-comments:delete",{annotationId:t})},e.on("click",t=>{const o=e.dom.getParent(t.target,`span.${m}`);if(!o)return;const n=o.getAttribute("data-annotation-id");n&&(e.dom.select(`.${m}`).forEach(a=>a.classList.remove("active")),o.classList.add("active"),e.fire("inline-comments:select",{annotationId:n}))}),e.ui.registry.addButton("inlineComment",{icon:"comment",tooltip:"Add comment",onAction:()=>e.execCommand("inline-comments:add")}),e.ui.registry.addContextToolbar("inlineCommentToolbar",{predicate:()=>!e.selection.isCollapsed(),items:"inlineComment",position:"selection",scope:"editor"})}i.registerInlineComments=s,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})}));
